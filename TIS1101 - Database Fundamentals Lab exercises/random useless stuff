create database what;
connect to what;

DROP TABLE lecture;

CREATE TABLE student
(
	stu_id int not null primary key, 
	stu_name varchar(40) NOT NULL UNIQUE,
	stu_gender char(1) DEFAULT 'M' CHECK(stu_gender IN ('M', 'F'))
);

CREATE TABLE lecture
(
	lec_id int not null primary key,
	lec_name varchar(40) not null unique,
	lec_max_classes int check(lec_max_classes BETWEEN 0 AND 10),
	stu_id int,
	foreign key(stu_id) REFERENCES student
);

CREATE TABLE fare
(
	fare_id int not null primary key,
	fare_decimal decimal(7,3) CHECK(fare_decimal BETWEEN 1111.111 AND 9999.999)
);

insert into fare VALUES(1, 1111.112);

ALTER TABLE fare
ADD current_stock int;

ALTER TABLE fare
ADD min_order_stock int;

ALTER TABLE fare
ADD to_order int;

CREATE PROCEDURE addstudent (IN id int, IN name varchar(40), IN gender char(1), IN flag varchar(20))
BEGIN
	IF (flag = 'add') THEN
		INSERT INTO student VALUES(id, name, gender);
	ELSE 
		INSERT INTO student VALUES(id, name, gender);
	END IF;
END@ 

CREATE PROCEDURE displayTable(IN displaytablename VARCHAR(30))
BEGIN
	DECLARE c cursor with return for
	SELECT * FROM student;
	OPEN c;	
END@

CREATE PROCEDURE  printstudent ()
BEGIN 
	DECLARE c cursor with return for
		SELECT * FROM student;
    	OPEN c;
END@



SELECT * FROM student;
SELECT * FROM lecture;

INSERT INTO student VALUES(1, 'b', 'M');
INSERT INTO student VALUES(2, 'c', 'F');
INSERT INTO student VALUES(3, 'd', 'F');
INSERT INTO student VALUES(4, 'f', 'M');
INSERT INTO student VALUES(5, 'FDSFSD', 'F');

INSERT INTO lecture VALUES(1, 'rwe', 1, 1);
INSERT INTO lecture VALUES(2, 'fds', 4, 3);
INSERT INTO lecture VALUES(3, 'dgdfg', 5, 2);
INSERT INTO lecture VALUES(4, 'fwefsda', 6, 4);
INSERT INTO lecture VALUES(5, 'rewt', 6, 5);

CALL addstudent(6, 'whatever man', 'M', 'add');

CREATE TABLE tojoin
(
	tojoin_id int not null primary key,
	stu_name varchar(40) NOT NULL UNIQUE,
	stu_gender char(1) DEFAULT 'M' CHECK(stu_gender IN ('M', 'F')),
	lec_name varchar(40) not null unique,
	lec_max_classes int check(lec_max_classes BETWEEN 0 AND 10),
	stu_id int,
	foreign key(stu_id) REFERENCES student
);

INSERT INTO tojoin
(SELECT student.stu_id, student.stu_name, student.stu_gender, lecture.lec_name, lecture.lec_max_classes, lecture.stu_id
FROM student, lecture
WHERE student.stu_id = lecture.stu_id);

select * from tojoin;
select * from student;

SELECT student.stu_id, student.stu_name, student.stu_gender, lecture.lec_name, lecture.lec_max_classes
FROM student, lecture
WHERE student.stu_id = lecture.stu_id;

